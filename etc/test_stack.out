testing/test_stack
supercalifragilisticexpialidocious
port_lacp_state{dp_id="0xb1",dp_name="nz-kiwi-t1sw1",port="28",port_description="egress"} 3.0
port_lacp_state{dp_id="0xb2",dp_name="nz-kiwi-t1sw2",port="28",port_description="egress"} 0.0
"0e:00:00:00:02:03"
"faucet_dp_mac for DPs are not identical"
3
faucet_config_warning_count 2
%%% initial solid state
Starting stack-solid test...
(UNKNOWN) [192.168.1.1] 23 (telnet) : Connection timed out
(UNKNOWN) [192.168.1.1] 443 (https) : Connection refused
pcap sane 0 1 1 1
pcap bcast 1 0 1 1
telnet 1 https 2
forch-faux-0: ping -c 10 192.168.1.1 10
forch-faux-0: ping -c 10 192.168.1.2 10
forch-faux-0: ping -c 10 192.168.1.3 10
forch-faux-1: ping -c 10 192.168.1.0 10
forch-faux-1: ping -c 10 192.168.1.2 10
forch-faux-1: ping -c 10 192.168.1.3 10
forch-faux-2: ping -c 10 192.168.1.0 10
forch-faux-2: ping -c 10 192.168.1.1 10
forch-faux-2: ping -c 10 192.168.1.3 10
forch-faux-3: ping -c 10 192.168.1.0 10
forch-faux-3: ping -c 10 192.168.1.1 10
forch-faux-3: ping -c 10 192.168.1.2 10
Done with stack-solid test.
Running forch-solid tests
@system_state-solid
"nz-kiwi"
52
"http://localhost.n:9020"
"split"
@dataplane_state-solid
"damaged"
"egress: nz-kiwi-t1sw1:28, nz-kiwi-t1sw2:28 down"
34
"active"
"active"
4
@switch_state-solid
15
"nz-kiwi-t1sw1"
9
28
"147058200627"
""
"active"
null
3
@cpn_state-solid
2
"127.0.0.1"
"healthy"
"240.0.0.1"
"down"
@process_state-solid
1
"healthy"
"broken"
""
0
5
@list_hosts-solid
"http://127.0.0.1:9019/?list_hosts?eth_src=9a:02:57:1e:8f:01"
"http://127.0.0.1:9019/?host_path?eth_src=9a:02:57:1e:8f:01&eth_dst=9a:02:57:1e:8f:02"
@host_path-solid
"nz-kiwi-t1sw1"
10
"nz-kiwi-t1sw1"
28
2
%%% healthy state
Running forch-healthy tests
@system_state-healthy
"nz-kiwi"
3
"http://localhost.n:9020"
"healthy"
@dataplane_state-healthy
"healthy"
"egress: nz-kiwi-t1sw1:28"
1
"active"
"active"
1
@switch_state-healthy
0
"nz-kiwi-t1sw1"
9
28
"147058200627"
""
"active"
null
0
@cpn_state-healthy
1
"127.0.0.1"
"healthy"
"240.0.0.1"
"healthy"
@process_state-healthy
1
"healthy"
"healthy"
"sleep 50.3231"
3
5
@list_hosts-healthy
"http://127.0.0.1:9019/?list_hosts?eth_src=9a:02:57:1e:8f:01"
"http://127.0.0.1:9019/?host_path?eth_src=9a:02:57:1e:8f:01&eth_dst=9a:02:57:1e:8f:02"
@host_path-healthy
"nz-kiwi-t1sw1"
10
"nz-kiwi-t1sw1"
28
2
process_state{process="faucet"} 1
process_state{process="gauge"} 1
process_state{process="forch"} 1
process_state{process="sleep"} 1
process_state{process="sleep"} 0
%%% t2sw3 down, cpn nz-kiwi-ctl1 up, t1sw1-eth9 down
Starting stack-linkd test...
(UNKNOWN) [192.168.1.1] 23 (telnet) : Connection timed out
(UNKNOWN) [192.168.1.1] 443 (https) : Connection refused
pcap sane 1 1 1 1
pcap bcast 1 0 1 1
telnet 1 https 2
forch-faux-0: ping -c 10 192.168.1.1 10
forch-faux-0: ping -c 10 192.168.1.2 10
forch-faux-0: ping -c 10 192.168.1.3 0
forch-faux-1: ping -c 10 192.168.1.0 10
forch-faux-1: ping -c 10 192.168.1.2 10
forch-faux-1: ping -c 10 192.168.1.3 0
forch-faux-2: ping -c 10 192.168.1.0 10
forch-faux-2: ping -c 10 192.168.1.1 10
forch-faux-2: ping -c 10 192.168.1.3 0
forch-faux-3: ping -c 10 192.168.1.0 0
forch-faux-3: ping -c 10 192.168.1.1 0
forch-faux-3: ping -c 10 192.168.1.2 0
Done with stack-linkd test.
%%% t1sw1-eth10 down
Starting stack-twod test...
(UNKNOWN) [192.168.1.1] 23 (telnet) : Connection timed out
(UNKNOWN) [192.168.1.1] 443 (https) : Connection refused
pcap sane 1 1 1 1
pcap bcast 1 0 1 1
telnet 1 https 2
forch-faux-0: ping -c 10 192.168.1.1 10
forch-faux-0: ping -c 10 192.168.1.2 10
forch-faux-0: ping -c 10 192.168.1.3 0
forch-faux-1: ping -c 10 192.168.1.0 10
forch-faux-1: ping -c 10 192.168.1.2 10
forch-faux-1: ping -c 10 192.168.1.3 0
forch-faux-2: ping -c 10 192.168.1.0 10
forch-faux-2: ping -c 10 192.168.1.1 10
forch-faux-2: ping -c 10 192.168.1.3 0
forch-faux-3: ping -c 10 192.168.1.0 0
forch-faux-3: ping -c 10 192.168.1.1 0
forch-faux-3: ping -c 10 192.168.1.2 0
Done with stack-twod test.
Running forch-twod tests
@system_state-twod
"nz-kiwi"
56
"http://localhost.n:9020"
"broken"
@dataplane_state-twod
"broken"
"egress: nz-kiwi-t1sw1:28; broken switches: ['nz-kiwi-t2sw3']; broken links: ['nz-kiwi-t1sw1:11@nz-kiwi-t2sw3:50', 'nz-kiwi-t1sw1:9@nz-kiwi-t2sw1:50', 'nz-kiwi-t1sw2:10@nz-kiwi-t2sw2:52', 'nz-kiwi-t1sw2:11@nz-kiwi-t2sw3:52']"
35
"down"
"active"
8
@switch_state-twod
17
"nz-kiwi-t1sw2"
9
6
"147058200627"
"Switches in broken state: nz-kiwi-t2sw3"
"active"
null
1
@cpn_state-twod
2
"127.0.0.1"
"healthy"
"240.0.0.1"
"healthy"
@process_state-twod
2
"healthy"
"healthy"
"sleep 50.3231"
3
4
@list_hosts-twod
"http://127.0.0.1:9019/?list_hosts?eth_src=9a:02:57:1e:8f:01"
"http://127.0.0.1:9019/?host_path?eth_src=9a:02:57:1e:8f:01&eth_dst=9a:02:57:1e:8f:02"
@host_path-twod
"nz-kiwi-t1sw2"
6
"nz-kiwi-t1sw2"
6
3
%%% steady state ip address check
"192.168.1.1"
""
%%% t2sw3 up, cpn nz-kiwi-t2sw2 up, t1sw1-eth6 down, t1sw1-eth11 down
Starting stack-broken test...
(UNKNOWN) [192.168.1.1] 23 (telnet) : Connection timed out
(UNKNOWN) [192.168.1.1] 443 (https) : Connection timed out
pcap sane 0 1 0 1
pcap bcast 1 0 1 1
telnet 0 https 0
forch-faux-0: ping -c 10 192.168.1.1 0
forch-faux-0: ping -c 10 192.168.1.2 10
forch-faux-0: ping -c 10 192.168.1.3 0
forch-faux-1: ping -c 10 192.168.1.0 0
forch-faux-1: ping -c 10 192.168.1.2 0
forch-faux-1: ping -c 10 192.168.1.3 10
forch-faux-2: ping -c 10 192.168.1.0 10
forch-faux-2: ping -c 10 192.168.1.1 0
forch-faux-2: ping -c 10 192.168.1.3 0
forch-faux-3: ping -c 10 192.168.1.0 0
forch-faux-3: ping -c 10 192.168.1.1 10
forch-faux-3: ping -c 10 192.168.1.2 0
Done with stack-broken test.
